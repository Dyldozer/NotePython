; Returns an object with OneDrive sign-in status
; Example:
; result := IsOneDriveSignedIn()
; if (result.HasPersonal)
;     MsgBox, Personal OneDrive signed in as % result.PersonalEmail
; if (result.HasBusiness)
;     MsgBox, Business OneDrive signed in as % result.BusinessEmail
; if (!result.HasPersonal && !result.HasBusiness)
;     MsgBox, No OneDrive accounts signed in

IsOneDriveSignedIn() {
    result := {}

    ; --- Personal Account ---
    RegRead, personalEmail, HKEY_CURRENT_USER\Software\Microsoft\OneDrive\Accounts\Personal, UserEmail
    if !(ErrorLevel || personalEmail = "")
    {
        result.HasPersonal := true
        result.PersonalEmail := personalEmail
    }
    else
        result.HasPersonal := false

    ; --- Business / Work Accounts ---
    ; Business accounts are stored under ...\Accounts\Business1, Business2, etc.
    businessFound := false
    Loop
    {
        key := "HKEY_CURRENT_USER\Software\Microsoft\OneDrive\Accounts\Business" . A_Index
        RegRead, businessEmail, %key%, UserEmail
        if (ErrorLevel != 0)
            break ; no more BusinessX keys
        if (businessEmail != "")
        {
            result.HasBusiness := true
            result.BusinessEmail := businessEmail
            businessFound := true
            break ; if you only need the first, remove break to collect all
        }
    }
    if (!businessFound)
        result.HasBusiness := false

    return result
}
