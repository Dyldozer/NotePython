#Requires AutoHotkey v2.0

helpMode := false ; global flag

; --- Create GUI ---
gui := Gui("Resize", "Button Help Example")
gui.SetFont("s10")

; Create Help button
helpBtn := gui.AddButton("w120 h30", "Help Mode")
helpBtn.OnEvent("Click", ToggleHelpMode)

; Create other action buttons
btns := Map()

btns["Open"]  := gui.AddButton("w120 h30", "Open File")
btns["Save"]  := gui.AddButton("w120 h30", "Save File")
btns["Exit"]  := gui.AddButton("w120 h30", "Exit Program")

; Hook all buttons to the same handler
for name, btn in btns
    btn.OnEvent("Click", ButtonHandler.Bind(name))

gui.Show("AutoSize Center")
return

; --- FUNCTIONS ---

ToggleHelpMode(*) {
    global helpMode, helpBtn
    helpMode := !helpMode
    if helpMode {
        helpBtn.Text := "Help Mode (ON)"
        helpBtn.Opt("cBlue") ; change color text if supported
        ToolTip("Help mode activated — click any button for info")
    } else {
        helpBtn.Text := "Help Mode"
        ToolTip("Help mode off — buttons act normally")
        SetTimer(()->ToolTip(""), -1000)
    }
}

ButtonHandler(name, *) {
    global helpMode
    if helpMode {
        ShowButtonHelp(name)
    } else {
        RunButtonAction(name)
    }
}

ShowButtonHelp(name) {
    helpText := Map(
        "Open", "Opens a file from disk.",
        "Save", "Saves the current file.",
        "Exit", "Closes the program safely."
    )
    MsgBox(helpText[name], "Help: " name)
}

RunButtonAction(name) {
    switch name {
        case "Open": MsgBox("Opening file...")
        case "Save": MsgBox("Saving file...")
        case "Exit": ExitApp()
    }
}
