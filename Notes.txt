; Select folder
folder := FileSelectFolder("Select folder to scan for .ah2 files")
if !folder
{
    MsgBox "No folder selected."
    ExitApp
}

count := 0

; Loop through all files recursively
Loop Files folder "\*.ah2", "R"
{
    oldPath := A_LoopFileFullPath
    newPath := RegExReplace(oldPath, "\.ah2$", ".ahk")
    try
    {
        FileMove(oldPath, newPath)
        count++
    }
    catch as e
    {
        MsgBox "Failed to rename:`n" oldPath "`nError: " e.Message
    }
}

MsgBox "Finished renaming " count " file(s)."
ExitApp
